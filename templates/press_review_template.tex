from jinja2 import Environment, FileSystemLoader

# Contenu corrigé du template LaTeX
latex_template = r"""
\documentclass[11pt]{article}
\usepackage[utf8]{inputenc}
\usepackage[a4paper,margin=2.5cm]{geometry}
\usepackage{lmodern}
\usepackage{hyperref}
\usepackage{xcolor}
\usepackage{titlesec}
\usepackage{fancyhdr}
\usepackage{tocloft}
\usepackage{enumitem}
\usepackage{datetime}
\usepackage{url}
\def\UrlBreaks{\do\/\do-}

\pagestyle{fancy}
\fancyhf{}
\rhead{Weekly Press Review}
\lhead{\today}
\cfoot{\thepage}

\titleformat{\section}{\Large\bfseries\sffamily\color{blue}}{}{0em}{}
\titleformat{\subsection}{\bfseries\color{black}}{}{0em}{}

\setlength{\parskip}{0.5em}
\setlength{\parindent}{0pt}

\begin{document}
\sloppy
\begin{center}
    {\LARGE \textbf{Weekly Press Review}}\\
    \vspace{0.5em}
    \textit{Generated on {{ generated_date }}}
\end{center}

\vspace{1em}
\tableofcontents
\newpage

{% for company in companies %}
\section{ {{ company.company }} }
{% for article in company.articles %}
\subsection{ {{ article.title }} }
\textbf{Published:} {{ article.published }} \\
\textbf{Summary:} {{ article.summary }} \\
\textbf{Link:} \url{ {{ article.link }} }

\vspace{1em}
{% endfor %}
{% endfor %}

\end{document}
"""

# Écriture du template corrigé dans le fichier press_review_template.tex
with open("press_review_template.tex", "w", encoding="utf-8") as f:
    f.write(latex_template)

print("✅ Le fichier press_review_template.tex a été corrigé et sauvegardé.")
with open("press_review_template.tex", "w", encoding="utf-8") as f:
    f.write(corrected_template)
